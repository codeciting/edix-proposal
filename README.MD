# EditorX

## 数据结构

- [文档结构]()

    文档结构用来储存文档的完整内容

- [操作结构]()

    操作结构用来储存对文档的操作列表，每个操作都需要支持撤回。每一个文档只在编辑器实例中储存***有限的***操作历史。
    
- [用户行为]()

    用户行为包含所有行为记录，但不需支持撤回操作

## 模块

### 前端

- [编辑器]()
    
    编辑器实时与服务器连接，操作文档结构以及同步服务文档结构。需要将文档结构映射为HTML。
    
- [阅读器]()

    阅读器负责渲染文档结构，需要将文档结构映射为HTML。

### 后端

- [插件系统]()

    插件系统管理所有插件。

- [编辑器实例]()

    运行一个编辑器实例，维护文档结构以及操作结构。一个编辑器实例的地址唯一，并在最后一个用户退出后失效。
    编辑器实例同时支持有限个用户协作操作。

- [阅读器实例]()
    
    阅读器实例长期存在（应不耗费资源），一个文档对应一个阅读器。阅读器用来缓存文档结构等数据，加速访问。
    阅读器亦可能运行某些插件代码。
    
- [文档储存]()

    文档储存负责持久化储存文档结构以及每个文档的历史结构。
    

## 原型设计

- 文档结构

    在文档储存模块中，使用单一XML文件储存文档，接口调用使用结构化数据。

- 操作结构

    操作结构储存操作人、操作时间、文档MD5标记（验证后才可UNDO/REDO）、节点路径、新旧值。操作历史为有限长度循环队列，
    支持有限的UNDO\REDO操作。

- 用户行为

- 插件

    插件需要提供一个配置文件，提供插件名、版本、入口类地址、资源地址。（入口类类型以及资源类型需讨论）
    
